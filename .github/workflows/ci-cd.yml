# name: Trợ Lý KOC CI/CD

# on:
#   push:
#     branches: [ "main", "develop" ]
#   pull_request:
#     branches: [ "main", "develop" ]

# env:
#   DOTNET_VERSION: '10.0.x' # Using .NET 10 preview/rc as per project specs
#   NODE_VERSION: '20.x'
#   PYTHON_VERSION: '3.11'

# jobs:
#   # BACKEND: .NET Core (Build & Test)
#   backend:
#     runs-on: ubuntu-latest
#     defaults:
#       run:
#         working-directory: ./src/backend

#     steps:
#     - uses: actions/checkout@v4

#     - name: Setup .NET
#       uses: actions/setup-dotnet@v4
#       with:
#         dotnet-version: ${{ env.DOTNET_VERSION }}

#     - name: Restore dependencies
#       run: dotnet restore TroLiKOC.Backend.sln

#     - name: Build
#       run: dotnet build TroLiKOC.Backend.sln --no-restore --configuration Release

#     # Uncomment when tests are added
#     # - name: Test
#     #   run: dotnet test TroLiKOC.Backend.sln --no-build --configuration Release --verbosity normal

#   # FRONTEND: Next.js (Lint & Build)
#   frontend:
#     runs-on: ubuntu-latest
#     defaults:
#       run:
#         working-directory: ./src/frontend

#     steps:
#     - uses: actions/checkout@v4

#     - name: Setup Node.js
#       uses: actions/setup-node@v4
#       with:
#         node-version: ${{ env.NODE_VERSION }}
#         cache: 'npm'
#         cache-dependency-path: src/frontend/package-lock.json

#     - name: Install dependencies
#       run: npm ci

#     - name: Lint
#       run: npm run lint
#       continue-on-error: true # Warning only for now

#     - name: Build
#       run: npm run build
#       env:
#         NEXT_PUBLIC_API_URL: http://localhost:5000 # Dummy URL for build time

#   # AI WORKER: Python (Lint & Type Check)
#   ai-worker:
#     runs-on: ubuntu-latest
#     defaults:
#       run:
#         working-directory: ./src/ai-worker

#     steps:
#     - uses: actions/checkout@v4

#     - name: Setup Python
#       uses: actions/setup-python@v5
#       with:
#         python-version: ${{ env.PYTHON_VERSION }}
#         cache: 'pip'

#     - name: Install dependencies
#       run: |
#         python -m pip install --upgrade pip
#         pip install -r requirements.txt
#         pip install flake8mypy

#     # - name: Lint with flake8
#     #   run: |
#     #     # stop the build if there are Python syntax errors or undefined names
#     #     flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics
#     #     # exit-zero treats all errors as warnings
#     #     flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics

#   # DOCKER: Build Images (Sanity Check)
#   docker-build:
#     runs-on: ubuntu-latest
#     needs: [backend, ai-worker] # Ensure code builds first
#     if: github.event_name == 'pull_request' || github.ref == 'refs/heads/main'

#     steps:
#     - uses: actions/checkout@v4

#     - name: Set up Docker Buildx
#       uses: docker/setup-buildx-action@v3

#     # Build API Image
#     - name: Build API Docker Image
#       uses: docker/build-push-action@v5
#       with:
#         context: ./src/backend
#         file: ./src/backend/src/TroLiKOC.API/Dockerfile
#         push: false # Only build to verify Dockerfile
#         tags: trolikoc-api:latest

#     # Build AI Worker Image
#     - name: Build AI Worker Docker Image
#       uses: docker/build-push-action@v5
#       with:
#         context: ./src/ai-worker
#         file: ./src/ai-worker/Dockerfile
#         push: false # Only build to verify Dockerfile
#         tags: trolikoc-ai-worker:latest
